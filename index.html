<!doctype html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>O Bestiário do Herói — v1.2 “O Eterno Retorno”</title>

    <!-- Tone.js (CDN) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>

    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <div class="wrap">
        <div id="game" class="card">
            <canvas id="c" width="860" height="480"></canvas>

            <!-- VN overlay -->
            <div id="vnContainer" class="vn-box fade" style="display:none;margin-top:12px;">
                <div style="display:flex;">
                    <div id="vnPortrait" class="portrait"></div>
                    <div style="flex:1">
                        <div id="vnSpeaker" class="muted" style="font-weight:700;margin-bottom:6px"></div>
                        <div id="vnText" class="vn-text" style="min-height:72px"></div>
                        <div class="vn-controls">
                            <button id="vnNext">Continuar</button>
                            <button id="vnSkip" class="secondary">Pular VN</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="interludeBox" class="vn-box fade hidden" style="margin-top:12px;">
                <div id="interludeText" class="vn-text"></div>
                <div class="vn-controls" style="margin-top:8px"><button id="interludeContinue">Prosseguir</button></div>
            </div>
        </div>

        <div id="ui">
            <div class="card">
                <h2>O Bestiário do Herói — v1.2</h2>
                <div class="muted">Modo atual: <span id="modeLabel">Intro</span></div>
                <div style="margin-top:12px">
                    <button id="openBest">Bestiário</button>
                    <button id="openVN" class="secondary">Ver Prólogo (VN)</button>
                    <button id="executarAcao">Executar Ação</button>
                    <button id="resetPattern">Resetar</button>
                    <button id="nextBoss" style="display:none">Arena</button>
                </div>

                <div style="margin-top:12px" class="stat">
                    <div class="muted">Sequência registrada:</div>
                    <div id="patternContainer" style="min-height:28px"></div>
                </div>
            </div>

            <div class="card">
                <h2 class="center">Log de Batalha</h2>
                <div id="log"></div>
            </div>

            <div class="card">
                <div class="muted">Como Jogar:</div>
                <ul>
                    <li>VN introdutório → explore as anotações do herói anterior.</li>
                    <li>Abra o Bestiário para ver padrões; reproduza-os na sequência.</li>
                    <li>Use teclado ou botões on-screen. Falhar 3x causa dano.</li>
                    <li>No final há um segredo que pode quebrar o ciclo — procure pistas no Bestiário.</li>
                </ul>
                <footer>Protótipo v1.2 — O Eterno Retorno</footer>
            </div>
        </div>
    </div>

    <!-- Bestiary Modal -->
    <div id="bestiaryModal" class="modal hidden">
        <div class="modal-inner">
            <div style="display:flex;justify-content:space-between;align-items:center">
                <h3 id="bestiaryTitle">Bestiário</h3>
                <div><button id="closeBest" class="secondary">Fechar</button></div>
            </div>
            <div style="display:flex;gap:12px;margin-top:12px">
                <div style="flex:1">
                    <div id="bestiaryList" class="bestiary-grid"></div>
                </div>
                <div style="width:360px;background:#fff8e6;padding:12px;border-radius:8px;color:#2b2b28">
                    <div id="bestiaryPreview"><em>Selecione uma entrada...</em></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Over -->
    <div id="gameOverModal" class="modal hidden">
        <div class="modal-inner center" style="background:#06202a;color:#eaf6ff;padding:24px;border-radius:10px;">
            <h3 style="color:#e11d48">GAME OVER</h3>
            <p id="gameOverText">Sua jornada termina por enquanto.</p>
            <div style="margin-top:12px"><button id="restartGame">Tentar Novamente</button></div>
        </div>
    </div>

    <!-- On-screen controls -->
    <div id="onScreenControls" class="controls">
        <div class="dpad">
            <div></div>
            <div class="control-btn" id="btn-up">↑</div>
            <div></div>
            <div class="control-btn" id="btn-left">←</div>
            <div class="control-btn" id="btn-down">↓</div>
            <div class="control-btn" id="btn-right">→</div>
        </div>
        <div class="action-btns">
            <div class="control-btn big-btn" id="btn-attack">⚔</div>
            <div class="control-btn big-btn" id="btn-special">✨</div>
        </div>
    </div>

    <script src="audio.js"></script>
    <script src="game.js"></script>
</body>

</html>